<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SaveUp - Smart Finance Tracker for Bangladesh</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    
    <style>
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .login-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .spinner {
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            width: 24px;
            height: 24px;
            animation: spin 0.6s linear infinite;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCRJPBPmUU9lxcTv_xKhaOebPhcVJlHtgY",
            authDomain: "saveup-baa19.firebaseapp.com",
            projectId: "saveup-baa19",
            storageBucket: "saveup-baa19.firebasestorage.app",
            messagingSenderId: "185527062347",
            appId: "1:185527062347:web:b3590315906f2c8f8fe3206"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        // Money Personality Quiz Data
        const quizQuestions = [
            {
                id: 1,
                question: "If someone gave you ‡ß≥50,000, what would you do?",
                options: [
                    { text: "Save it for the future", personality: "lion" },
                    { text: "Invest it for profit", personality: "fox" },
                    { text: "Spend on my dreams", personality: "unicorn" },
                    { text: "Use for family welfare", personality: "dragon" }
                ]
            },
            {
                id: 2,
                question: "What do you do with extra money at month-end?",
                options: [
                    { text: "Deposit in bank", personality: "lion" },
                    { text: "Invest in stocks/business", personality: "fox" },
                    { text: "Spend on my hobbies", personality: "unicorn" },
                    { text: "Give to family", personality: "dragon" }
                ]
            },
            {
                id: 3,
                question: "How would you describe your spending style?",
                options: [
                    { text: "Calculated and planned", personality: "lion" },
                    { text: "Focus on profitable purchases", personality: "fox" },
                    { text: "Buy what I want", personality: "unicorn" },
                    { text: "Consider others first", personality: "dragon" }
                ]
            },
            {
                id: 4,
                question: "During Eid, how do you spend?",
                options: [
                    { text: "Shop within budget", personality: "lion" },
                    { text: "Bargain for best deals", personality: "fox" },
                    { text: "Buy what I like", personality: "unicorn" },
                    { text: "Buy for everyone", personality: "dragon" }
                ]
            },
            {
                id: 5,
                question: "First thing after receiving salary?",
                options: [
                    { text: "Set aside savings", personality: "lion" },
                    { text: "Pay bills and debts", personality: "fox" },
                    { text: "Buy something for myself", personality: "unicorn" },
                    { text: "Give to family", personality: "dragon" }
                ]
            },
            {
                id: 6,
                question: "How do you handle sudden large expenses?",
                options: [
                    { text: "Use emergency fund", personality: "lion" },
                    { text: "Pay in installments", personality: "fox" },
                    { text: "Borrow if needed", personality: "unicorn" },
                    { text: "Get help from family", personality: "dragon" }
                ]
            },
            {
                id: 7,
                question: "What's your future plan?",
                options: [
                    { text: "Buy a house/flat", personality: "lion" },
                    { text: "Start my own business", personality: "fox" },
                    { text: "Travel abroad/fulfill dreams", personality: "unicorn" },
                    { text: "Ensure family happiness", personality: "dragon" }
                ]
            },
            {
                id: 8,
                question: "Your online shopping habit?",
                options: [
                    { text: "Buy only necessities", personality: "lion" },
                    { text: "Buy during discounts", personality: "fox" },
                    { text: "Buy what I like", personality: "unicorn" },
                    { text: "Buy for family", personality: "dragon" }
                ]
            },
            {
                id: 9,
                question: "How do you split bills with friends?",
                options: [
                    { text: "Pay my share", personality: "lion" },
                    { text: "Split equally", personality: "fox" },
                    { text: "I pay for everyone", personality: "unicorn" },
                    { text: "Whoever can afford more", personality: "dragon" }
                ]
            },
            {
                id: 10,
                question: "What's your savings goal?",
                options: [
                    { text: "Security and stability", personality: "lion" },
                    { text: "Wealth growth", personality: "fox" },
                    { text: "Dream fulfillment", personality: "unicorn" },
                    { text: "Family's future", personality: "dragon" }
                ]
            }
        ];

        const personalities = {
            lion: {
                name: "Lion ü¶Å - The Responsible Saver",
                description: "You're disciplined and plan ahead. Future security is your top priority.",
                tips: "Keep following your budget and build that emergency fund!",
                color: "from-yellow-400 to-orange-500"
            },
            fox: {
                name: "Fox ü¶ä - The Smart Investor",
                description: "You're clever and make profitable decisions. You know how to make money work.",
                tips: "Continue learning about investments and calculate your risks wisely.",
                color: "from-orange-400 to-red-500"
            },
            unicorn: {
                name: "Unicorn ü¶Ñ - The Dream Spender",
                description: "You love enjoying life. A bit of caution will take you far!",
                tips: "Track your expenses and start small savings - you got this!",
                color: "from-pink-400 to-purple-500"
            },
            dragon: {
                name: "Dragon üêâ - The Family Provider",
                description: "You'd do anything for family. But remember to save for yourself too!",
                tips: "Balance between family and personal savings for long-term security.",
                color: "from-green-400 to-blue-500"
            }
        };

        // Login Component with REDIRECT method (better for mobile)
        function LoginPage({ onLoginSuccess }) {
            const [loading, setLoading] = useState(false);
            const [error, setError] = useState("");

            const handleGoogleLogin = async () => {
                setLoading(true);
                setError("");
                
                try {
                    const provider = new firebase.auth.GoogleAuthProvider();
                    // Use REDIRECT instead of POPUP (works better on mobile)
                    await auth.signInWithRedirect(provider);
                } catch (error) {
                    console.error("Login error:", error);
                    setLoading(false);
                    
                    // Better error messages
                    if (error.code === 'auth/popup-blocked') {
                        setError("Popup was blocked. Please allow popups for this site.");
                    } else if (error.code === 'auth/unauthorized-domain') {
                        setError("Domain not authorized. Please contact support.");
                    } else if (error.code === 'auth/network-request-failed') {
                        setError("Network error. Please check your internet connection.");
                    } else {
                        setError(`Login failed: ${error.message}`);
                    }
                }
            };

            return (
                <div className="login-container">
                    <div className="bg-white rounded-3xl shadow-2xl p-8 md:p-12 max-w-md w-full mx-4 fade-in">
                        <div className="text-center mb-8">
                            <h1 className="text-5xl font-bold mb-2">
                                <span className="bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent">
                                    SaveUp
                                </span>
                            </h1>
                            <p className="text-gray-600 text-lg">
                                Smart Finance Tracker for Bangladesh
                            </p>
                        </div>

                        <div className="mb-8">
                            <div className="flex items-center justify-center space-x-4 mb-6">
                                <div className="text-4xl">üí∞</div>
                                <div className="text-4xl">üìä</div>
                                <div className="text-4xl">üéØ</div>
                            </div>
                            <h2 className="text-2xl font-bold text-gray-800 mb-3 text-center">
                                Start Your Financial Freedom Journey
                            </h2>
                            <p className="text-gray-600 text-center">
                                Track Expenses ‚Ä¢ Set Goals ‚Ä¢ Build Savings
                            </p>
                        </div>

                        {error && (
                            <div className="bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-4 text-sm">
                                {error}
                            </div>
                        )}

                        <button
                            onClick={handleGoogleLogin}
                            disabled={loading}
                            className="w-full bg-white border-2 border-gray-300 text-gray-700 font-semibold py-4 px-6 rounded-xl hover:bg-gray-50 hover:border-gray-400 transition-all duration-200 flex items-center justify-center space-x-3 shadow-md disabled:opacity-50 disabled:cursor-not-allowed"
                        >
                            {loading ? (
                                <>
                                    <div className="spinner"></div>
                                    <span>Signing in...</span>
                                </>
                            ) : (
                                <>
                                    <svg className="w-6 h-6" viewBox="0 0 24 24">
                                        <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                                        <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                                        <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                                        <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                                    </svg>
                                    <span>Sign in with Google</span>
                                </>
                            )}
                        </button>

                        <p className="text-xs text-gray-500 text-center mt-6">
                            By signing in, you agree to our Terms & Privacy Policy
                        </p>
                    </div>
                </div>
            );
        }

        // Main App Component
        function App() {
            const [user, setUser] = useState(null);
            const [loading, setLoading] = useState(true);
            const [currentPage, setCurrentPage] = useState('dashboard');
            const [showQuiz, setShowQuiz] = useState(false);
            const [personality, setPersonality] = useState(null);
            const [expenses, setExpenses] = useState([]);
            const [showExpenseModal, setShowExpenseModal] = useState(false);
            const [goals, setGoals] = useState([]);
            const [monthlyBudget, setMonthlyBudget] = useState(30000);

            // Check auth state on mount AND handle redirect result
            useEffect(() => {
                // Handle redirect result first
                auth.getRedirectResult().then(async (result) => {
                    if (result.user) {
                        // User successfully signed in via redirect
                        console.log("Redirect successful, user:", result.user.email);
                        await db.collection('users').doc(result.user.uid).set({
                            displayName: result.user.displayName,
                            email: result.user.email,
                            photoURL: result.user.photoURL,
                            createdAt: firebase.firestore.FieldValue.serverTimestamp()
                        }, { merge: true });
                    }
                }).catch((error) => {
                    console.error("Redirect error:", error);
                    setLoading(false);
                });

                // Listen to auth state changes
                const unsubscribe = auth.onAuthStateChanged(async (user) => {
                    console.log("Auth state changed:", user ? user.email : "No user");
                    if (user) {
                        setUser(user);
                        // Load user data from Firestore
                        try {
                            const userDoc = await db.collection('users').doc(user.uid).get();
                            if (userDoc.exists) {
                                const userData = userDoc.data();
                                console.log("User data loaded:", userData);
                                if (userData.personality) {
                                    setPersonality(userData.personality);
                                } else {
                                    setShowQuiz(true);
                                }
                                if (userData.expenses) setExpenses(userData.expenses);
                                if (userData.goals) setGoals(userData.goals);
                                if (userData.monthlyBudget) setMonthlyBudget(userData.monthlyBudget);
                            } else {
                                console.log("No user data, showing quiz");
                                setShowQuiz(true);
                            }
                        } catch (error) {
                            console.error("Error loading user data:", error);
                            setShowQuiz(true);
                        }
                    } else {
                        console.log("No user logged in");
                    }
                    setLoading(false);
                });

                return () => unsubscribe();
            }, []);

            // Save data to Firestore whenever it changes
            useEffect(() => {
                if (user && personality) {
                    db.collection('users').doc(user.uid).set({
                        personality,
                        expenses,
                        goals,
                        monthlyBudget
                    }, { merge: true });
                }
            }, [user, personality, expenses, goals, monthlyBudget]);

            const handleLogout = async () => {
                try {
                    await auth.signOut();
                    setUser(null);
                    setPersonality(null);
                    setExpenses([]);
                    setGoals([]);
                } catch (error) {
                    console.error("Logout error:", error);
                }
            };

            if (loading) {
                return (
                    <div className="min-h-screen flex flex-col items-center justify-center gradient-bg">
                        <div className="spinner mb-4" style={{width: '48px', height: '48px', borderWidth: '4px'}}></div>
                        <div className="text-white text-2xl">Loading...</div>
                    </div>
                );
            }

            if (!user) {
                return <LoginPage onLoginSuccess={setUser} />;
            }

            if (showQuiz) {
                return <MoneyPersonalityQuiz onComplete={(result) => {
                    setPersonality(result);
                    setShowQuiz(false);
                }} />;
            }

            const thisMonthExpenses = expenses.reduce((sum, exp) => sum + exp.amount, 0);
            const remaining = monthlyBudget - thisMonthExpenses;
            const todayExpenses = expenses
                .filter(exp => new Date(exp.date).toDateString() === new Date().toDateString())
                .reduce((sum, exp) => sum + exp.amount, 0);
            const healthScore = Math.max(0, Math.min(100, ((monthlyBudget - thisMonthExpenses) / monthlyBudget * 100)));

            return (
                <div className="min-h-screen bg-gray-50">
                    {/* Header */}
                    <header className="gradient-bg text-white p-4 shadow-lg">
                        <div className="max-w-7xl mx-auto flex justify-between items-center">
                            <h1 className="text-2xl font-bold">SaveUp</h1>
                            <div className="flex items-center space-x-4">
                                <img 
                                    src={user.photoURL} 
                                    alt={user.displayName}
                                    className="w-10 h-10 rounded-full border-2 border-white"
                                />
                                <span className="hidden md:inline">{user.displayName}</span>
                                <button
                                    onClick={handleLogout}
                                    className="bg-white text-purple-600 px-4 py-2 rounded-lg font-semibold hover:bg-gray-100 transition"
                                >
                                    Logout
                                </button>
                            </div>
                        </div>
                    </header>

                    {/* Navigation */}
                    <nav className="bg-white shadow-md sticky top-0 z-10">
                        <div className="max-w-7xl mx-auto px-4">
                            <div className="flex space-x-8 overflow-x-auto">
                                {['dashboard', 'expenses', 'goals', 'reports'].map(page => (
                                    <button
                                        key={page}
                                        onClick={() => setCurrentPage(page)}
                                        className={`py-4 px-6 font-semibold whitespace-nowrap capitalize ${
                                            currentPage === page
                                                ? 'text-purple-600 border-b-2 border-purple-600'
                                                : 'text-gray-600 hover:text-purple-600'
                                        }`}
                                    >
                                        {page === 'dashboard' && 'üìä Dashboard'}
                                        {page === 'expenses' && 'üí∏ Expenses'}
                                        {page === 'goals' && 'üéØ Goals'}
                                        {page === 'reports' && 'üìà Reports'}
                                    </button>
                                ))}
                            </div>
                        </div>
                    </nav>

                    {/* Main Content */}
                    <main className="max-w-7xl mx-auto p-4 pb-20">
                        {currentPage === 'dashboard' && (
                            <Dashboard
                                personality={personality}
                                thisMonthExpenses={thisMonthExpenses}
                                remaining={remaining}
                                todayExpenses={todayExpenses}
                                healthScore={healthScore}
                                expenses={expenses}
                                onAddExpense={() => setShowExpenseModal(true)}
                            />
                        )}
                        {currentPage === 'expenses' && (
                            <ExpensesPage
                                expenses={expenses}
                                onAddExpense={() => setShowExpenseModal(true)}
                                onDeleteExpense={(id) => setExpenses(expenses.filter(e => e.id !== id))}
                            />
                        )}
                        {currentPage === 'goals' && (
                            <GoalsPage goals={goals} setGoals={setGoals} />
                        )}
                        {currentPage === 'reports' && (
                            <ReportsPage expenses={expenses} />
                        )}
                    </main>

                    {/* Expense Modal */}
                    {showExpenseModal && (
                        <ExpenseModal
                            onClose={() => setShowExpenseModal(false)}
                            onSave={(expense) => {
                                setExpenses([...expenses, { ...expense, id: Date.now() }]);
                                setShowExpenseModal(false);
                            }}
                        />
                    )}
                </div>
            );
        }

        // Dashboard Component
        function Dashboard({ personality, thisMonthExpenses, remaining, todayExpenses, healthScore, expenses, onAddExpense }) {
            const categoryData = expenses.reduce((acc, exp) => {
                acc[exp.category] = (acc[exp.category] || 0) + exp.amount;
                return acc;
            }, {});

            return (
                <div className="space-y-6">
                    {/* Personality Badge */}
                    {personality && (
                        <div className={`bg-gradient-to-r ${personalities[personality].color} rounded-2xl p-6 text-white shadow-lg`}>
                            <h2 className="text-2xl font-bold mb-2">{personalities[personality].name}</h2>
                            <p className="mb-2">{personalities[personality].description}</p>
                            <p className="text-sm opacity-90">üí° {personalities[personality].tips}</p>
                        </div>
                    )}

                    {/* Stats Cards */}
                    <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                        <div className="bg-white rounded-2xl p-6 shadow-lg">
                            <div className="text-gray-600 text-sm mb-2">This Month</div>
                            <div className="text-2xl font-bold text-purple-600">‡ß≥{thisMonthExpenses.toLocaleString()}</div>
                        </div>
                        <div className="bg-white rounded-2xl p-6 shadow-lg">
                            <div className="text-gray-600 text-sm mb-2">Remaining</div>
                            <div className="text-2xl font-bold text-green-600">‡ß≥{remaining.toLocaleString()}</div>
                        </div>
                        <div className="bg-white rounded-2xl p-6 shadow-lg">
                            <div className="text-gray-600 text-sm mb-2">Today</div>
                            <div className="text-2xl font-bold text-blue-600">‡ß≥{todayExpenses.toLocaleString()}</div>
                        </div>
                        <div className="bg-white rounded-2xl p-6 shadow-lg">
                            <div className="text-gray-600 text-sm mb-2">Health Score</div>
                            <div className="text-2xl font-bold text-pink-600">{Math.round(healthScore)}%</div>
                        </div>
                    </div>

                    {/* Add Expense Button */}
                    <button
                        onClick={onAddExpense}
                        className="w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white font-bold py-4 px-6 rounded-2xl shadow-lg hover:shadow-xl transition"
                    >
                        ‚ûï Add New Expense
                    </button>

                    {/* Category Breakdown */}
                    {Object.keys(categoryData).length > 0 && (
                        <div className="bg-white rounded-2xl p-6 shadow-lg">
                            <h3 className="text-xl font-bold mb-4">Spending by Category</h3>
                            {Object.entries(categoryData).map(([category, amount]) => (
                                <div key={category} className="mb-4">
                                    <div className="flex justify-between mb-2">
                                        <span className="font-semibold">{category}</span>
                                        <span className="text-purple-600">‡ß≥{amount.toLocaleString()}</span>
                                    </div>
                                    <div className="w-full bg-gray-200 rounded-full h-2">
                                        <div
                                            className="bg-gradient-to-r from-purple-600 to-pink-600 h-2 rounded-full"
                                            style={{ width: `${(amount / thisMonthExpenses) * 100}%` }}
                                        ></div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    )}

                    {/* Recent Expenses */}
                    {expenses.length > 0 && (
                        <div className="bg-white rounded-2xl p-6 shadow-lg">
                            <h3 className="text-xl font-bold mb-4">Recent Expenses</h3>
                            {expenses.slice(-5).reverse().map(exp => (
                                <div key={exp.id} className="flex justify-between items-center py-3 border-b last:border-b-0">
                                    <div>
                                        <div className="font-semibold">{exp.note || exp.category}</div>
                                        <div className="text-sm text-gray-600">{new Date(exp.date).toLocaleDateString()}</div>
                                    </div>
                                    <div className="text-right">
                                        <div className="font-bold text-purple-600">‡ß≥{exp.amount.toLocaleString()}</div>
                                        <div className="text-sm text-gray-600">{exp.category}</div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    )}
                </div>
            );
        }

        // Expenses Page
        function ExpensesPage({ expenses, onAddExpense, onDeleteExpense }) {
            return (
                <div className="space-y-6">
                    <button
                        onClick={onAddExpense}
                        className="w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white font-bold py-4 px-6 rounded-2xl shadow-lg hover:shadow-xl transition"
                    >
                        ‚ûï Add New Expense
                    </button>

                    <div className="bg-white rounded-2xl p-6 shadow-lg">
                        <h2 className="text-2xl font-bold mb-6">All Expenses</h2>
                        {expenses.length === 0 ? (
                            <p className="text-gray-600 text-center py-8">No expenses added yet</p>
                        ) : (
                            <div className="space-y-4">
                                {expenses.slice().reverse().map(exp => (
                                    <div key={exp.id} className="flex justify-between items-center p-4 bg-gray-50 rounded-xl">
                                        <div className="flex-1">
                                            <div className="font-semibold text-lg">{exp.note || exp.category}</div>
                                            <div className="text-sm text-gray-600">{exp.category} ‚Ä¢ {new Date(exp.date).toLocaleDateString()}</div>
                                        </div>
                                        <div className="flex items-center space-x-4">
                                            <div className="text-xl font-bold text-purple-600">‡ß≥{exp.amount.toLocaleString()}</div>
                                            <button
                                                onClick={() => onDeleteExpense(exp.id)}
                                                className="text-red-500 hover:text-red-700 font-bold"
                                            >
                                                ‚ùå
                                            </button>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        // Goals Page
        function GoalsPage({ goals, setGoals }) {
            const [showAddGoal, setShowAddGoal] = useState(false);
            const [newGoal, setNewGoal] = useState({ name: '', target: '', saved: 0 });

            const addGoal = () => {
                if (newGoal.name && newGoal.target) {
                    setGoals([...goals, { ...newGoal, id: Date.now(), target: parseFloat(newGoal.target) }]);
                    setNewGoal({ name: '', target: '', saved: 0 });
                    setShowAddGoal(false);
                }
            };

            const updateGoalSavings = (id, amount) => {
                setGoals(goals.map(g => g.id === id ? { ...g, saved: g.saved + amount } : g));
            };

            return (
                <div className="space-y-6">
                    <button
                        onClick={() => setShowAddGoal(!showAddGoal)}
                        className="w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white font-bold py-4 px-6 rounded-2xl shadow-lg hover:shadow-xl transition"
                    >
                        {showAddGoal ? '‚ùå Cancel' : '‚ûï Add New Goal'}
                    </button>

                    {showAddGoal && (
                        <div className="bg-white rounded-2xl p-6 shadow-lg">
                            <input
                                type="text"
                                placeholder="Goal name (e.g., New Phone)"
                                value={newGoal.name}
                                onChange={(e) => setNewGoal({ ...newGoal, name: e.target.value })}
                                className="w-full p-3 border-2 border-gray-300 rounded-lg mb-4"
                            />
                            <input
                                type="number"
                                placeholder="Target amount (‡ß≥)"
                                value={newGoal.target}
                                onChange={(e) => setNewGoal({ ...newGoal, target: e.target.value })}
                                className="w-full p-3 border-2 border-gray-300 rounded-lg mb-4"
                            />
                            <button
                                onClick={addGoal}
                                className="w-full bg-green-500 text-white font-bold py-3 rounded-lg hover:bg-green-600 transition"
                            >
                                ‚úÖ Create Goal
                            </button>
                        </div>
                    )}

                    {goals.length === 0 ? (
                        <div className="bg-white rounded-2xl p-8 shadow-lg text-center text-gray-600">
                            No goals set yet. Start by adding your first savings goal!
                        </div>
                    ) : (
                        <div className="space-y-4">
                            {goals.map(goal => {
                                const progress = (goal.saved / goal.target) * 100;
                                return (
                                    <div key={goal.id} className="bg-white rounded-2xl p-6 shadow-lg">
                                        <div className="flex justify-between items-center mb-4">
                                            <h3 className="text-xl font-bold">{goal.name}</h3>
                                            <span className="text-sm text-gray-600">{Math.round(progress)}%</span>
                                        </div>
                                        <div className="w-full bg-gray-200 rounded-full h-4 mb-4">
                                            <div
                                                className="bg-gradient-to-r from-purple-600 to-pink-600 h-4 rounded-full transition-all duration-500"
                                                style={{ width: `${Math.min(progress, 100)}%` }}
                                            ></div>
                                        </div>
                                        <div className="flex justify-between items-center mb-4">
                                            <span className="text-gray-600">Saved: ‡ß≥{goal.saved.toLocaleString()}</span>
                                            <span className="text-gray-600">Target: ‡ß≥{goal.target.toLocaleString()}</span>
                                        </div>
                                        <div className="flex space-x-2">
                                            <button
                                                onClick={() => updateGoalSavings(goal.id, 500)}
                                                className="flex-1 bg-green-500 text-white py-2 rounded-lg hover:bg-green-600 transition"
                                            >
                                                +‡ß≥500
                                            </button>
                                            <button
                                                onClick={() => updateGoalSavings(goal.id, 1000)}
                                                className="flex-1 bg-green-500 text-white py-2 rounded-lg hover:bg-green-600 transition"
                                            >
                                                +‡ß≥1000
                                            </button>
                                            <button
                                                onClick={() => {
                                                    const amount = prompt('How much to add?');
                                                    if (amount) updateGoalSavings(goal.id, parseFloat(amount));
                                                }}
                                                className="flex-1 bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600 transition"
                                            >
                                                Custom
                                            </button>
                                        </div>
                                    </div>
                                );
                            })}
                        </div>
                    )}
                </div>
            );
        }

        // Reports Page
        function ReportsPage({ expenses }) {
            const monthlyData = expenses.reduce((acc, exp) => {
                const month = new Date(exp.date).toLocaleDateString('en-US', { month: 'long', year: 'numeric' });
                if (!acc[month]) acc[month] = {};
                acc[month][exp.category] = (acc[month][exp.category] || 0) + exp.amount;
                return acc;
            }, {});

            return (
                <div className="space-y-6">
                    <div className="bg-white rounded-2xl p-6 shadow-lg">
                        <h2 className="text-2xl font-bold mb-6">Monthly Reports</h2>
                        {Object.keys(monthlyData).length === 0 ? (
                            <p className="text-gray-600 text-center py-8">Not enough data yet</p>
                        ) : (
                            Object.entries(monthlyData).map(([month, categories]) => {
                                const total = Object.values(categories).reduce((sum, amt) => sum + amt, 0);
                                return (
                                    <div key={month} className="mb-8">
                                        <h3 className="text-xl font-bold mb-4">{month}</h3>
                                        <div className="mb-4">
                                            <div className="flex justify-between mb-2">
                                                <span className="font-semibold">Total Spent</span>
                                                <span className="text-purple-600 font-bold">‡ß≥{total.toLocaleString()}</span>
                                            </div>
                                        </div>
                                        <div className="space-y-3">
                                            {Object.entries(categories).map(([category, amount]) => (
                                                <div key={category}>
                                                    <div className="flex justify-between mb-1">
                                                        <span>{category}</span>
                                                        <span className="text-gray-600">‡ß≥{amount.toLocaleString()}</span>
                                                    </div>
                                                    <div className="w-full bg-gray-200 rounded-full h-2">
                                                        <div
                                                            className="bg-gradient-to-r from-purple-600 to-pink-600 h-2 rounded-full"
                                                            style={{ width: `${(amount / total) * 100}%` }}
                                                        ></div>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                );
                            })
                        )}
                    </div>
                </div>
            );
        }

        // Expense Modal
        function ExpenseModal({ onClose, onSave }) {
            const [expense, setExpense] = useState({
                amount: '',
                category: 'Food',
                note: '',
                date: new Date().toISOString().split('T')[0]
            });

            const categories = ['Food', 'Transport', 'Entertainment', 'Bills', 'Shopping', 'Health', 'Education', 'Others'];

            const handleSubmit = (e) => {
                e.preventDefault();
                if (expense.amount) {
                    onSave({ ...expense, amount: parseFloat(expense.amount) });
                }
            };

            return (
                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
                    <div className="bg-white rounded-2xl p-6 max-w-md w-full shadow-2xl">
                        <div className="flex justify-between items-center mb-6">
                            <h2 className="text-2xl font-bold">Add New Expense</h2>
                            <button onClick={onClose} className="text-2xl">&times;</button>
                        </div>
                        <form onSubmit={handleSubmit} className="space-y-4">
                            <div>
                                <label className="block text-sm font-semibold mb-2">Amount (‡ß≥)</label>
                                <input
                                    type="number"
                                    value={expense.amount}
                                    onChange={(e) => setExpense({ ...expense, amount: e.target.value })}
                                    className="w-full p-3 border-2 border-gray-300 rounded-lg"
                                    placeholder="0"
                                    required
                                />
                            </div>
                            <div>
                                <label className="block text-sm font-semibold mb-2">Category</label>
                                <select
                                    value={expense.category}
                                    onChange={(e) => setExpense({ ...expense, category: e.target.value })}
                                    className="w-full p-3 border-2 border-gray-300 rounded-lg"
                                >
                                    {categories.map(cat => (
                                        <option key={cat} value={cat}>{cat}</option>
                                    ))}
                                </select>
                            </div>
                            <div>
                                <label className="block text-sm font-semibold mb-2">Note (optional)</label>
                                <input
                                    type="text"
                                    value={expense.note}
                                    onChange={(e) => setExpense({ ...expense, note: e.target.value })}
                                    className="w-full p-3 border-2 border-gray-300 rounded-lg"
                                    placeholder="What was this for?"
                                />
                            </div>
                            <div>
                                <label className="block text-sm font-semibold mb-2">Date</label>
                                <input
                                    type="date"
                                    value={expense.date}
                                    onChange={(e) => setExpense({ ...expense, date: e.target.value })}
                                    className="w-full p-3 border-2 border-gray-300 rounded-lg"
                                />
                            </div>
                            <button
                                type="submit"
                                className="w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white font-bold py-3 rounded-lg hover:shadow-lg transition"
                            >
                                ‚úÖ Add Expense
                            </button>
                        </form>
                    </div>
                </div>
            );
        }

        // Money Personality Quiz
        function MoneyPersonalityQuiz({ onComplete }) {
            const [currentQuestion, setCurrentQuestion] = useState(0);
            const [answers, setAnswers] = useState([]);

            const handleAnswer = (personality) => {
                const newAnswers = [...answers, personality];
                setAnswers(newAnswers);

                if (currentQuestion < quizQuestions.length - 1) {
                    setCurrentQuestion(currentQuestion + 1);
                } else {
                    const counts = newAnswers.reduce((acc, p) => {
                        acc[p] = (acc[p] || 0) + 1;
                        return acc;
                    }, {});
                    const winner = Object.keys(counts).reduce((a, b) => counts[a] > counts[b] ? a : b);
                    onComplete(winner);
                }
            };

            const progress = ((currentQuestion + 1) / quizQuestions.length) * 100;

            return (
                <div className="min-h-screen gradient-bg flex items-center justify-center p-4">
                    <div className="bg-white rounded-3xl shadow-2xl p-8 max-w-2xl w-full">
                        <div className="mb-8">
                            <h2 className="text-3xl font-bold text-center mb-4">What's Your Money Personality?</h2>
                            <div className="w-full bg-gray-200 rounded-full h-3">
                                <div
                                    className="bg-gradient-to-r from-purple-600 to-pink-600 h-3 rounded-full transition-all duration-300"
                                    style={{ width: `${progress}%` }}
                                ></div>
                            </div>
                            <p className="text-center text-gray-600 mt-2">Question {currentQuestion + 1} of {quizQuestions.length}</p>
                        </div>

                        <div className="mb-8">
                            <h3 className="text-2xl font-bold mb-6 text-center">{quizQuestions[currentQuestion].question}</h3>
                            <div className="space-y-3">
                                {quizQuestions[currentQuestion].options.map((option, index) => (
                                    <button
                                        key={index}
                                        onClick={() => handleAnswer(option.personality)}
                                        className="w-full text-left p-4 border-2 border-gray-300 rounded-xl hover:border-purple-600 hover:bg-purple-50 transition-all duration-200 font-semibold"
                                    >
                                        {option.text}
                                    </button>
                                ))}
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        // Render App
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
